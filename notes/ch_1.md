
Practical Malware Analysis Notes

Ch. 1 Basic Static Techniques


1. VirusTotal web anti-virus malware scanning tool (wwww.virustotal.com) will provide valuable information
	by running the file through multiple engines.. While these tools are a good start they are flawed. They
	rely mainly on databases (file signatures) and behavioral/pattern-matching (heuristics) analysis. Bad
	actors can create new malware or tweak existing malware to go undetected by such tools.

2. Hash fingerprinting: Another useful step to identify malware is to generate a hash (MD5/SHA-1) of the
	malware. This hash can be used to search the Internet and be shared with other analysts.

3. Strings: Finding ASCII and Unicode strings can reveal useful information about the malware. Tools such 
	as Strings and rabin2 (Radare2) can find the strings in a file. ASCII characters are one byte and the
	string is terminated with the null byte 0x00. Unicode characters are two bytes and the strings are 
	terminated with double null bytes 0x00 0x00. These tools do not filter the found strings; It is up to
	the practitioner to decide what is random bytes that could be interpreted as characters and what are
	valid strings.
	- When a file has very little valid strings it has most likely been packed/obfuscated.
	- Packed files will call/import less functions. 
	- If the virtual size is larger than the size of raw data the program is probably packed.

4. If the malware seems to be packed try the PEid program to find information about the packer that was used.

5. File: Check the file format.

6. Consider Imported and linked functions:
	Static, Runtime, Dynamic. If a program loads functions by ordinal, these can be looked up using tools
	such as Dependency Walker.
	- DLLs can tell us a lot about a program. See page 17.

7. Exported functions

8. Time and date information.

- Definitions: 
	- Obfuscated: Attempted to hide execution
	- Packed: Compressed to stop analysis
	- Static linking: All code from the imported library is copied into the executable.
	- Runtime linking: Only connects to the library when the function is needed. Commonly used in packed malware.
	- Dynamic linking: Libraries are loaded at the start of the program. When the host calls a function the 
		function is ran in the library.

- Tools:
	- PEview
	- Dependency Walker 
	- Resource Hacker
	- Strings
	- Radare2
	- Hash Calculators
	- VirusTotal.com
	- PEBrowser
	- PE Explorer


- Other:
	- MS naming conventions:
		- Ex suffix means the function is a newer version of an older function with the same name.
		- A or W suffix are not part of the function name in the MS documentation but tell use the function takes
			an ASCII/Wide String as a parameter. 
	- All Delphi programs have a compile time of June 19th 1992.
